<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hydraulic Cylinder Calculation</title>
  <link rel="stylesheet" href="style.css" />
  <!-- SheetJS for Excel export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <!-- LOGIN -->
  <div id="loginContainer" class="login-box">
    <h2>Hydraulic Cylinder Calculation</h2>
    <p class="version-text">Version: v1.3.4</p>
    <div class="login-inputs">
      <label for="passwordInput">Password:</label>
      <input type="password" id="passwordInput" placeholder="Enter Password" />
      <button id="unlockBtn">Unlock</button>
      <p id="loginError" class="error"></p>
    </div>
  </div>

  <!-- MAIN APP (hidden until login) -->
  <div id="mainApp" style="display:none;">
    <header>
      <h1>Hydraulic Cylinder Calculation</h1>
    </header>

    <div class="controls">
      <button id="addCylinderBtn">Add Cylinder</button>
      <button id="findCylinderBtn">Find Cylinder Size</button>
      <button id="exportBtn">Export to Excel</button>
      <label><input type="checkbox" id="selectAllCheckbox"> Select All</label>
    </div>

    <!-- Main calculator inputs (kept simple and compatible) -->
    <section class="main-panel">
      <div class="row">
        <label>Cylinder Name</label>
        <input id="cylName" placeholder="Enter" />
        <label>No. of Cylinders</label>
        <input id="nCyl" type="number" value="1" min="1" />
      </div>

      <div class="row">
        <label>Bore Dia (mm)</label>
        <input id="boreDia" type="number" placeholder="Enter" />
        <label>Rod Dia (mm)</label>
        <input id="rodDia" type="number" placeholder="Enter" />
        <label>Stroke (mm)</label>
        <input id="stroke" type="number" placeholder="Enter" value="1500" />
      </div>

      <div class="row">
        <label>Time Option (Bore)</label>
        <select id="timeUnitB">
          <option value="sec">sec (for stroke)</option>
          <option value="mmsec">mm/s</option>
          <option value="mmin">m/min</option>
        </select>
        <label>Time Value (Bore)</label>
        <input id="timeValB" type="number" placeholder="Enter" />

        <label>Time Option (Rod)</label>
        <select id="timeUnitR">
          <option value="sec">sec (for stroke)</option>
          <option value="mmsec">mm/s</option>
          <option value="mmin">m/min</option>
        </select>
        <label>Time Value (Rod)</label>
        <input id="timeValR" type="number" placeholder="Enter" />
      </div>

      <div class="row">
        <label>Pressure/Force Mode (Bore)</label>
        <select id="pfModeB">
          <option value="pressure">Pressure (bar)</option>
          <option value="force">Force (kN)</option>
        </select>
        <label>Value (Bore)</label>
        <input id="pfValB" type="number" placeholder="Enter" />

        <label>Pressure/Force Mode (Rod)</label>
        <select id="pfModeR">
          <option value="pressure">Pressure (bar)</option>
          <option value="force">Force (kN)</option>
        </select>
        <label>Value (Rod)</label>
        <input id="pfValR" type="number" placeholder="Enter" />
      </div>

      <div class="row small-outputs">
        <div>Area Bore: <span id="areaB" class="output">--</span></div>
        <div>Area Rod: <span id="areaR" class="output">--</span></div>
        <div>Flow Bore: <span id="flowB" class="output">--</span></div>
        <div>Flow Rod: <span id="flowR" class="output">--</span></div>
      </div>

      <div class="row actions-row">
        <button id="addBtn">Add Cylinder</button>
        <button id="resetBtn">Reset</button>
      </div>
    </section>

    <!-- Saved list area (keeps compatibility) -->
    <section class="saved">
      <h3>Saved Cylinders</h3>
      <table id="savedList">
        <thead><tr><th>Select</th><th>Name</th><th>Details</th><th>Action</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- FIND CYLINDER MODAL -->
    <div id="findModal" class="modal" aria-hidden="true">
      <div class="modal-content">
        <h3>Find Cylinder Size</h3>

        <label>Weight</label>
        <input id="inputWeight" type="number" placeholder="Enter" />
        <select id="weightUnit">
          <option value="tonne">tonne</option>
          <option value="kg">kg</option>
        </select>

        <label>Capacity (kN)</label>
        <input id="inputCapacity" type="number" placeholder="Enter" />
        <select id="capUnit">
          <option value="kN">kN</option>
          <option value="N">N</option>
        </select>

        <label>Pressure (bar)</label>
        <input id="inputPressure" type="number" placeholder="Enter" />

        <label>No. of Cylinders</label>
        <input id="inputQty" type="number" value="1" min="1" />

        <label><input id="inputEqual" type="checkbox" checked /> All Cylinders Hold Entered Weight</label>

        <label>Rod Type</label>
        <select id="rodType">
          <option value="light">Light</option>
          <option value="standard" selected>Standard</option>
          <option value="heavy">Heavy</option>
        </select>

        <hr/>

        <div class="find-results">
          <div>Per Cylinder Load: <span id="calcPerCyl">--</span></div>
          <div>Calculated Bore: <span id="calcBore">--</span></div>
          <div>Recommended Rods: <span id="calcRod">--</span></div>
          <div>Nearest ISO Bore: <select id="isoBore"><option value="">--</option></select></div>
          <div>Nearest ISO Rod: <select id="isoRod"><option value="">--</option></select></div>

          <!-- NEW safety fields (readonly) -->
          <div class="safety-row">
            <label>Rod Safety Factor:</label>
            <input id="rodSafetyFactor" readonly />
            <label>Safety Status:</label>
            <input id="rodSafetyStatus" readonly />
          </div>
        </div>

        <div class="modal-actions">
          <button id="applyFindBtn">Apply</button>
          <button id="resetFindBtn">Reset</button>
          <button id="closeFindBtn">Close</button>
        </div>
      </div>
    </div>

    <footer>
      <p>Â© Design Hydraulics 2025</p>
      <p class="version">v1.3.4</p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
